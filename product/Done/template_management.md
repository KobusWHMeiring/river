# PRD: Task Template Management Interface

## 1. Problem Statement
Currently, `TaskTemplate` entries (which define default instructions for common tasks like "Litter Run" or "Weeding") can only be managed via the Django Admin interface. This disconnects the manager's workflow from the main application and requires higher-level technical access for simple instructional updates.

## 2. Strategic Goal
To provide a user-friendly, in-app management interface for Task Templates, allowing managers to refine standard operating procedures (SOPs) directly within the "River" UI.

## 3. Proposed Scope
- **Template List View:** A clean, searchable list of all existing templates.
- **Template CRUD:** Dedicated forms for creating, editing, and deleting templates.
- **Role Integration:** While currently open to all authenticated users (per MVP rules), the UI will be designed to fit into the "Manager" workflow.
- **Aesthetic:** High-information density table or card list matching the `Section List` design.

## 4. Technical Constraints
- Must use `TaskTemplateForm` (already partially defined in `forms.py`).
- Must maintain the relationship with existing `Task` objects (deleting a template should not delete tasks that used it - `on_delete=models.SET_NULL` is already in place).

---

# User Stories (Generated by Technical PO)

## Story 1: Task Template List View
**Value Proposition:** As a Manager, I want to see all our standard task templates in one place, so that I can ensure our instructions are consistent across all river sections.

**Technical Implementation Path:**
- Target File: `core/views.py`
  - Create `TaskTemplateListView` (LoginRequiredMixin, ListView).
- Target File: `core/urls.py`
  - Add path `templates/` for the list view.
- Target File: `core/templates/core/task_template_list.html`
  - Create a professional table showing Name, Task Type, Assignee Type, and a snippet of the Instructions.

**Acceptance Criteria (AC):**
- [ ] List displays all templates sorted by name.
- [ ] Each row has an "Edit" button.
- [ ] Task types are displayed using their human-readable labels (e.g., "Litter Run" instead of `litter_run`).

**The Test Plan (MANDATORY):**
- **Unit Test:** Verify `TaskTemplateListView` returns the correct queryset.
- **Integration Test:** Navigate to the templates list; verify that the 16+ real-world templates are visible.

---

## Story 2: In-App Template Editing
**Value Proposition:** As a Manager, I want to update the default instructions for "Planting" tasks to include new seasonal guidelines without having to log into the Admin panel.

**Technical Implementation Path:**
- Target File: `core/views.py`
  - Create `TaskTemplateUpdateView` and `TaskTemplateCreateView`.
- Target File: `core/templates/core/task_template_form.html`
  - Implement a clean form with a large textarea for `default_instructions`.
- Target File: `core/forms.py`
  - Ensure `TaskTemplateForm` includes all necessary fields and validation.

**Acceptance Criteria (AC):**
- [ ] Form includes Name, Task Type, Assignee Type, and Default Instructions.
- [ ] Success message is shown after saving.
- [ ] Redirects back to the Template List.

**The Test Plan (MANDATORY):**
- **Integration Test:** Edit an existing template's instructions. Verify that NEW tasks created using this template auto-populate with the updated text.
- **Edge Case:** "What if a template name is left blank?" (Verify form validation prevents saving).

---

## Story 3: Template Categorization & Filtering
**Value Proposition:** As a Manager, I want to quickly filter templates by "Team" or "Manager" types, so that I can manage our field SOPs separately from administrative tasks.

**Technical Implementation Path:**
- Target File: `core/templates/core/task_template_list.html`
  - Add simple "pills" or a dropdown to filter the list by `assignee_type` or `task_type`.
  - Use Vanilla JS to hide/show rows for immediate feedback.

**Acceptance Criteria (AC):**
- [ ] User can filter by "Team" vs "Manager".
- [ ] User can filter by activity type (Litter, Weeding, etc.).

**The Test Plan (MANDATORY):**
- **Integration Test:** Click "Team" filter; verify that only Team-assigned templates remain visible in the DOM.

---

**CRITICAL STOP RULE:**
We are moving Admin-level settings into the User UI. Should we add a specific "Settings" or "Management" sidebar category to house this and the Section management, or keep them as standalone top-level items?
